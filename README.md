# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Типы данных

Главная страница
```
export interface IPage {
  catalog: HTMLElement[] - контейнер c  карточками продуктов
  counter: number - счетчик продуктов в корзине
  locked: boolean - прокрутки страницы
}
```

Продукт
```
export interface IProduct{
    id: string  - id продукта
    image: string - URL картинки продукта
    name: string - название
    description: - описание
    category: string - категория
    prise: number | null - цена
    inBasket: boolean - продукт выбран / не выбран
}
```

Корзина
```
export interface IBasket{
    items: string[] - массив строк с товарами
    total: number - общая стоимость товаров
}
```

Тип вид оплаты
```
export type PaymentMethod = 'online' | 'offline'
```

Заказ
```
export interface IOrder {
  payment: PaymentMethod - способ оплаты
  email: string - e-mail 
  phone: string - телефон
  address: string - адрес
  total: number | null - сумма заказа
  items: string[] - массив id купленных товаров
}
```

Форма вида оплаты и адреса
```
interface IOrderForm {
  payment: PaymentMethod;
  address: string;
}
```

Форма контактных данных
```
export interface IContactsForm {
  phone: string - телефон
  email: string - e-mail
}
```

Форма успешного заказа
```
export interface IOrderResult {
  id: string - id заказа
  total: number - стоимость заказа
}
```

События клика
```
export interface ICardActions {
    onClick(event: MouseEvent): void;
}
```

## Архитектура приложения 
В архитектуре проекта используется парадигма MVP с брокером событий, код приложения разделен на следующие слои  : 

- данные (Model) - отвечают за хранение и передачу данных;
- представление (View) - отвечает за отображение данных на странице;
- презентер (Presenter) - отвечает за связь  между представлением и данными;


#### Класс Component
Базовый класс, является основой для компонентов проекта, реализует работу с DOM-элементами

#### Класс Api
 Класс для работы с сетью, принимает в конструктор экземпляр класса Api и предоставаляет методы для взаимодействия с бэкендом сервиса.

конструктор
```
baseUrl: string - базовый адрес для обращения приложения к серверу;
options: RequestInit -  опции  для установи заголовков запроса;
```

методы
```
handleResponse -  обработка ответа с сервера (преобразование тела ответа в JSON-объект);
GET - получение данных с сервера к указанному URI;
POST - отправка данных на сервер к указанному URI;
```
#### Класс EventEmitter
Используется в презентере как классом-посредник между слоями представление (View) и данные (Model) для обработки событий и в слоях приложения для генерации событий. Реализует интерфейс IEvents,в параметры конструктора ничего не передается

методы
```
on - установка обработчика на событие01
off - снятие обработчика с события
emit - инициирование события с данными
onAll - слушание всех событий
offAll - сброс всех обработчиков
trigger - создание коллбек триггера, генерирующего событие при вызове
```
#### Класс Model
Базовый компонент, предназначен для представления и для работы с данными

## Слой данных
#### Класс Product
Хранит информацию о товаре, используется для работы с карточкой товара

#### Класс Basket
класс для работы с корзиной

#### Класс Page
Класс расширяется интерфейсом IPage, используется для отображения главной страницы: логотипа, каталога товаров, иконки корзины и количество товаров в ней. Страница блокируется при открытии модального окна. 

Поля класса
```
counter: HTMLElement - DOM элемент счетчика товаров в корзине
catalog: HTMLElement - DOM элемент контейнера c  карточками
basket: HTMLElement - DOM элемент значка корзины
```
#### Класс Card
Класс описывает компоненту карточки товара, расширяется интерфейсом IProduct.  Используется для отображения карточки в галлереи товаров и просмотре карточки товара и корзине

Поля класса
```
image: HTMLImageElement - DOM элемент изображения продукта
name: HTMLElement - DOM элемент названия продукта
description: HTMLElement - DOM элемент описание продукта
category: HTMLElement - DOM элемент категории продукта
price: HTMLElement - DOM элемент цены продукта
```
#### Класс CardPreview
Класс описывает компоненту карточки товара при открытии в модальном окне, наследуется от класса Card.  

Поля класса
```
description: HTMLElement - DOM элемент описание продукта
button: HTMLButtonElement - DOM элемент кнопки в карточке
```
#### Класс CardBasket
Класс описывает компоненту карточки товара  в корзине: название, стоимость и индекс, наследуется от класса Component.  

Поля класса
```
index: HTMLElement - DOM элемент индекса товара в корзине
name: HTMLElement - DOM элемент названия продукта
price: HTMLElement - DOM элемент стоимости товара
button: HTMLButtonElement - DOM элемент кнопки удалить
```
#### Класс Basket
Отвечает за работу с корзиной, отражает информацию по товарам в корзине, стоимости каждой единицы товара, дает возможность удалить товар из корзины, считает и показывает общую сумму заказа.  

Поля класса
```
index: HTMLElement - DOM элемент индекса товара в корзине
name: HTMLElement - DOM элемент названия продукта
price: HTMLElement - DOM элемент стоимости товара
button: HTMLButtonElement - DOM элемент кнопки удалить
```

#### Класс Modal
Отвечает за работу с модальными окнами. 

Поля класса
```
closeButton: HTMLButtonElement - DOM элемент кнопки закрытия попапа
content: HTMLElement - DOM элемент с контентом
```

#### Класс Form
Отвечает за работу с формой заказа. 

Поля класса
```
submit: HTMLButtonElement - DOM элемент кнопки отправки данных формы
errors: HTMLElement - DOM элемент отображения ошибки валидации формы
```

#### Класс AppApi
Наследует класс Api и предоставаляет методы  взаимодействия с бэкендом сервиса для работы с продуктами и заказами. 

Поля класса
```
-
-
-
```

## Взаимодействие компонентов
Взаимодействие осуществляется с помощью событий которые генерирует брокер событий и обработчиков этих событий, описанных в index.ts

События изменения данных:

- items:change - изменение списка товаров;


Взаимодействие пользователя с интерфейсом

События карточек:
- card:select - выбор карточки для отображения в модальном окне;
- card:add - добавление товара в корзину;
- card:remove - удаление товара из корзины;

События корзины:
- basket:changed - изменение списка товаров в корзине;
- basket:open - открытие окна корзины;
- order:open - открытие формы заказа;
- card:remove - изменение товаров в корзине;

События оплаты:
- paymentCard:changed - изменение способа оплаты "Онлайн";
- paymentCash:changed - изменение способа оплаты "При получении";

События кнопок:
- order:submit - сабмит формы заказа;
- contact:submit - сабмит формы контакты;
- success:close - закрытие окна успешной покупки;

События попапа:
- modal:open - открытие модального окна;
- modal:close - закрытие модального окна.